# Pages 080-119 Notes

## Chapters/Sections Covered
- Section 2.2 Harmonic Trajectories (Sinusoidal Models) - continued from p.81
  - 2.2.6 Modeling Residual (p.92)
  - 2.2.7 Discussion (p.94)
- Section 2.3 Voice Pulse Modeling (p.95-119)
  - 2.3.1 Narrow-Band Voice Pulse Modeling (NBVPM) (p.98)
  - 2.3.2 Wide-Band Voice Pulse Modeling (WBVPM) (p.105)

## Key Findings

### Harmonic Trajectories / Sinusoidal Models
- IFFT synthesis (Depalle and Rodet 1990, Dutoit 1993) is more efficient than time-domain oscillators for low-pitch utterances
- Blackman-Harris 92dB window is ideal: main lobe is 8 bins wide with side lobes below 92dB from maximum
- Only 8H (8 harmonics) bins need to be computed for high frame rates

### Harmonic Mapping Function
- Simple identity mapping gamma(h) = h causes "Mickey Mouse effect" when pitch transposed
- Better approach: select closest source harmonic in frequency with constraint Delta_f <= |f'_0/2| for each harmonic
- Joint formant-pitch-modification mapping uses both timbre envelope T_timbre(f) and pitch transposition T_pitch

### Spectral Region Rendering Strategies (4 strategies compared)
1. **Adaptive region segmentation** - source region width matches synthesis pitch f'_0
2. **Fill gaps with source spectrum** - fills amplitude gaps with source bins
3. **Fill gaps with frequency shifted synthesis** - uses shifted segments of synthesis spectral regions
4. **Frequency warping** - non-linear frequency scaling preserving linear convolution around harmonics

### Rendering Strategy Results
- For upwards transposition: Basic technique (A), Strategy 2 (C), and Strategy 4 (E) preferred
- Strategy 1 (B) sounds too noisy
- Strategy 2 (C) good especially for breathy utterances
- Strategy 3 (D) sounds distorted and noisy
- Strategy 4 (E) smoothes utterances slightly
- For downwards transposition: no significant differences between strategies

### Modeling Residual (SMS Framework)
- Voice signals contain both harmonic (deterministic) and noise (stochastic) components
- Residual e(t) is obtained by subtracting deterministic component from original sound
- Shimmer and jitter (amplitude/frequency modulations) produce subharmonics
- TD-PSOLA and SINOLA algorithms can transform residual while preserving time-structure

### Voice Pulse Modeling
- Voice can be interpreted as a sequence of voice pulses at fundamental frequency rate
- Each pulse is the result of glottal pulse filtered by vocal tract
- TD-PSOLA (Moulines et al. 1989) is most well-known technique for voice pulse analysis

### NBVPM (Narrow-Band Voice Pulse Modeling)
- Models voice as train of pulses with band-limited spectral envelope
- Voice source spectral envelope decays exponentially (one resonance per KHz)
- Works in narrow-band conditions (analysis window covers several periods)
- Advantages: independent control of each voice pulse, avoids phase unwrapping
- Decomposition: harmonics, noise, and transients can be modified independently

### WBVPM (Wide-Band Voice Pulse Modeling)
- Estimates harmonic parameters via STFT analysis with widest possible band
- Each DFT bin corresponds to one harmonic when N = T (window = period)
- Window size adapted to cover around 3 periods for frequency resolution
- Zero-padding applied for temporal resolution

### Analysis Methods Compared
- Periodization: window input signal at rate T, repeat to length M for FFT
- Upsampling: upsample to match one period to closest FFT size M
- WBVPM: direct computation from resampled period spectrum

### Inharmonicity in Voice
- Formants cause phase shift around center frequency
- Harmonics near formants are affected, creating "instantaneous frequency" deviation
- Deviation can reach 50 cents (half semitone) during fast vibrato/transitions

## Equations Found

### Amplitude/Frequency Interpolation (eq. 2.49)
$$a'_{h,m}(n) = \begin{cases}
\left(1 + \frac{nT'_s}{\Delta'_t}\right)a'_{h,m} - \frac{nT'_s}{\Delta'_t}a'_{h,m-1} & \text{if } n < 0 \\
\left(1 + \frac{nT'_s}{\Delta'_t}\right)a'_{h,m+1} - \frac{nT'_s}{\Delta'_t}a'_{h,m} & \text{if } n \geq 0
\end{cases}$$

### Phase Interpolation (eq. 2.50)
$$\phi'_{0,h,m} = \phi'_{0,h,m-1} + 2\pi \frac{f'_{h,m-1} + f'_{h,m}}{2} \Delta'_t$$

### Time-Domain Sinusoid Synthesis (eq. 2.51)
$$s'(n) = \sum_{h=0}^{H'-1} a'_h(n) \cos\left(2\pi f'_h(n) n T'_s + \phi'_{0,h}(n)\right)$$

### IFFT Synthesis (eq. 2.52-2.53)
$$S'_w(k) = \sum_{n=0}^{N-1} w(n)s'(n)e^{-j2\pi nk/N} = \sum_{h=0}^{H-1} \frac{a'_h}{2} \left(W(k - f'_h T'_s N)e^{j\phi'_{0,h}} + W(k + f'_h T'_s N)e^{-j\phi'_{0,h}}\right)$$

### Overlap-Add Synthesis (eq. 2.54)
$$s'(n) = \sum_{m=0}^{M'-1} s'_m\left(n - m\frac{\Delta'_t}{T'_s}\right) \cdot \frac{w'_{ov}\left(n - m\frac{\Delta'_t}{T'_s}\right)}{w\left(n - m\frac{\Delta'_t}{T'_s}\right)}$$

### Spectral Modification Transform (eq. 2.57)
$$S_w(k) = \frac{a}{2}W(k - fT_sN)e^{j\phi_0}$$
$$S'_w(k) \approx \frac{a'}{a}S_w(k - (f' - f)T_sN)e^{j(\phi'_0 - \phi_0)}$$

### Harmonic Spectral Region Synthesis (eq. 2.58)
$$S'_w(k) = \sum_{h=0}^{H'-1} \left[\frac{a'_h}{a_{\gamma(h)}} e^{j(\phi'_{0,h} - \phi_{0,\gamma(h)})} S_w(k - x) \Upsilon_{\gamma(h)}(k - x)\right]$$
where $x \triangleq (f'_h - f_{\gamma(h)})T_sN$

### Harmonic Mapping with Timbre Scaling (eq. 2.59)
$$\gamma(h) = \text{round}\left(\frac{\bar{T}^{-1}_{timbre}(hT_{pitch}f_0)}{f_0}\right)$$

### Frequency Warping Function (eq. 2.62-2.64)
$$S'_w(k) = \sum_{h=0}^{H'-1} \left[\frac{a'_h}{a_{\gamma(h)}} e^{j(\phi'_{0,h} - \phi_{0,\gamma(h)})} S_w(\psi_h(k) - (f'_h - f_{\gamma(h)})T_sN) \Upsilon_{\gamma(h)}(\psi_h(k) - x)\right]$$

$$\psi(k) = \psi_I(k) + \frac{2|k|}{f_0 T_{pitch}}(\psi_L(k) - \psi_I(k)) = \frac{2(1 - T_{pitch})}{f_0 T^2_{pitch}}|k|k + k$$

### SMS Signal Decomposition (eq. 2.65)
$$s(t) = \sum_{p=1}^{P} a_p(t)\cos(\varphi_p(t)) + e(t)$$
where $a_p(t)$ and $\varphi_p(t)$ are instantaneous amplitude and phase of p-th partial

### Residual as Filtered Noise (eq. 2.66)
$$e(t) = \int_0^t h(t,\tau)u(\tau)d\tau$$
where $u(t)$ is white noise and $h(t,\tau)$ is time-varying filter response

### Sinusoid with Noise (eq. 2.67)
$$s_h(n) = \tilde{a}_h\left(\sqrt{1-\eta} + \sqrt{2\eta}[\xi_n * h_n]\right)e^{j2\pi f_h n T_s}$$
where $\eta$ is bandwidth coefficient controlling noise/harmonic balance

### STFT of Windowed Pulse (eq. 2.68-2.69)
$$x(n) = s(n) \cdot w(n)$$
$$X(e^{j\Omega}) = \sum_{n=0}^{N-1} x(n)e^{-j\Omega n}$$

### Overlapping Pulses STFT (eq. 2.70-2.71)
$$y(n) = s(n) + s(n-\Delta n) + s(n-2\Delta n) + ... + s(n-(R-1)\Delta n)$$
$$Y(e^{j\Omega}) = X(e^{j\Omega})\text{sinc}_R(\Omega\Delta n)$$
$$\text{sinc}_R(\Omega\Delta n) \triangleq X(e^{j\Omega}) \frac{\sin(0.5\Omega\Delta nR)}{\sin(0.5\Omega\Delta n)}$$

### NBVPM Reconstructed Pulse (eq. 2.77)
$$x'(n) = \frac{1}{N}\sum_{n=0}^{N-1}X'(e^{j\Omega})e^{j\Omega n}$$

### Window Size for NBVPM (eq. 2.78)
$$R = \frac{N \cdot pitch}{f_s}$$

### Phase Shift for Synthesis (eq. 2.79)
$$\Delta\phi_r(\Omega) = (t_r - t_{frame})\Omega$$

### WBVPM Periodic Signal (eq. 2.81)
$$s(n) = \sum_{k=1}^{T/2} a_k \cos\left(2\pi \frac{f_k}{f_s}n + \theta_k\right), \quad f_k = \frac{kf_s}{T}$$

### DFT Rectangular Window (eq. 2.84-2.85)
$$w_R(n) = \begin{cases}
1/N & \text{for } 0 \leq n \leq N-1 \\
0 & \text{for } n \notin [0,N-1]
\end{cases}$$
$$W_R(f) = e^{-j\pi\frac{f}{f_s}(N-1)} \frac{\sin(\pi\frac{f}{f_s}N)}{N\sin(\pi\frac{f}{f_s})}$$

### DFT Harmonic Parameters (eq. 2.88-2.89)
$$\bar{X}(k) = X\left(\frac{kf_s}{T}\right) = X(f_k) = S(f_k)$$
$$f_k = \frac{kf_s}{T}, \quad a_k = |\bar{X}(k)|, \quad \theta_k = \angle\bar{X}(k), \quad k = 1,...,\frac{T}{2}$$

### Inharmonicity Phase Model (eq. 2.93-2.94)
$$s(t) \approx \sum_{h=0}^{H-1} a_h(t)\cos(\phi_h(t))$$
$$\phi_h(t) = \begin{cases}
2\pi f_h t + C & \text{if } f_h \leq f_F(t) - W/2 \\
2\pi f_h t + C - \frac{A}{2}\left(1 + \frac{2}{W}(f_h - f_F(t))\right) & \text{if } |f_h - f_F(t)| < W/2 \\
2\pi f_h t + C - A & \text{if } f_h \geq f_F(t) + W/2
\end{cases}$$

### Instantaneous Frequency Near Formant (eq. 2.95-2.96)
$$\bar{f}_h(t) = \frac{1}{2\pi}\frac{d\phi_h(t)}{dt} = f_h + \frac{A}{2\pi W}\frac{df_F(t)}{dt}$$
$$f_F(t) = D + vt$$
$$\bar{f}_h(t) = f_h + \frac{A}{2\pi W}v$$

### Frequency Deviation in Cents (eq. 2.97)
$$d_h = 1200 \cdot \log_2\left(\frac{\bar{f}_h}{f_h}\right) = 1200 \cdot \log_2\left(1 + \frac{A}{2\pi W f_h}v\right)$$

### Vibrato-Induced Inharmonicity (eq. 2.98-2.100)
$$f_0(t) = C(1 + M\cos(2\pi R t))$$
$$\bar{f}_h(t) = hC(1 + M\cos(2\pi R t)) + \frac{AhCMR}{W}\sin(2\pi R t)$$
$$d_h = 1200 \cdot \log_2\left(1 + \frac{AMR\sin(2\pi R t)}{W(1 + M\cos(2\pi R t))}\right)$$

## Parameters Found

| Name | Symbol | Units | Value/Range | Notes |
|------|--------|-------|-------------|-------|
| Blackman-Harris window sidelobe | - | dB | -92 | Main lobe 8 bins wide |
| Harmonic mapping threshold | alpha | dB | 15 | For amplitude difference |
| Hysteresis threshold | beta | - | ~0.5 | For index change stability |
| Pitch transposition factor | T_pitch | ratio | 0.5-2.0 | 0.5 = octave down, 2.0 = octave up |
| Timbre expansion factor | T_timbre | ratio | ~1.18 | For pitch-timbre separation |
| f0 range female singing | f0 | Hz | 350-386 | Audio [12] |
| f0 range female scat | f0 | Hz | 127-318 | Audio [18] |
| f0 range male slow singing | f0 | Hz | 100-291 | Audio [24] |
| f0 range male soul singing | f0 | Hz | 98-211 | Audio [30] |
| f0 range male speech | f0 | Hz | 59-100 | Audio [36] |
| f0 range female speech | f0 | Hz | 190-410 | Audio [42] |
| Bandwidth coefficient | eta | - | 0-1 | 0=pure sinusoid, 1=pure noise |
| Window length NBVPM | R | periods | ~3 | Covers around 3 pitch periods |
| Frame rate NBVPM | - | fps | 172 | For 256 samples at 44.1kHz |
| Phase excursion | A | radians | ~PI | For formant influence |
| Formant bandwidth | W | Hz | ~250 | Typical vocal tract resonance |
| Vibrato modulation depth | M | ratio | 0.05-0.3 | Typical singing range |
| Vibrato rate | R | Hz | 2-7 | Typical singing range |
| Max deviation (vibrato) | d_h | cents | ~50 | Half semitone |
| WBVPM residual energy | - | dB | 11.14 | Average below narrow-band |
| MFCC window length | L | periods | 1-4 | Standard analysis |

## Rules/Algorithms

### Algorithm: Spectral Region Rendering (Strategy 1 - Adaptive Segmentation)
1. For each output harmonic h, compute source region boundaries:
   - b_h = f_h - f'_0/2
   - e_h = f_h + f'_0/2
2. Source regions may overlap (downwards transposition) or have gaps (upwards)
3. Apply square window Upsilon_h(k) to select spectral bins
4. Scale amplitude by a'_h/a_{gamma(h)} and rotate phase

### Algorithm: Spectral Region Rendering (Strategy 2 - Fill with Source)
1. Set source region width to match input pitch f_0
2. Fill amplitude gaps between harmonics with source spectrum bins
3. Scale bins by ratio of target/source timbre amplitude H_harm(T_timbre(k))/H_harm(k)
4. Preserves noise content between harmonics

### Algorithm: Spectral Region Rendering (Strategy 4 - Frequency Warping)
1. Apply warping function psi(k) to spectral regions
2. Warping is linear interpolation between identity psi_I(k) = k and scaling psi_L(k) = k/T_pitch
3. Phase correction required: Delta theta = 2*pi*l*(alpha-1)*f_0*Delta'_t (left gap), 2*pi*l*(1-alpha)*f_0*Delta'_t (right gap)
4. Eliminates amplitude gaps while preserving harmonic structure

### Algorithm: NBVPM Analysis
1. Compute STFT centered on each radiated pulse (constant frame rate ~172 fps)
2. Detect spectral peaks using quadratic interpolation
3. Estimate pitch using TWM algorithm extension (Cano 1998)
4. Select harmonic peaks guided by ideal harmonic distribution and amplitude/frequency
5. Modify phase using MFPA (maximally flat phase alignment)
6. Interpolate harmonic peaks using 3rd order spline at |X'(e^{j*Omega})|
7. Scale amplitude spectrum by 1/R where R = N*pitch/f_s

### Algorithm: NBVPM Synthesis
1. Generate pulse sequence from pitch envelope (T = 1/pitch)
2. Map each pulse to nearest analysis frame or interpolate between two closest frames
3. Apply time-stretch transformation using IFFT + overlap-add
4. Phase shift: Delta*phi_r(Omega) = (t_r - t_frame)*Omega
5. Limit shift to N/2 samples to avoid aliasing

### Algorithm: WBVPM Analysis
1. Segment input into consecutive periods defined by pulse onsets
2. For each period T samples, use rectangular window of length N = T
3. Compute DFT - each bin k corresponds to k-th harmonic
4. Extract: f_k = kf_s/T, a_k = |X(k)|, theta_k = angle(X(k))
5. Handle non-integer periods via periodization or upsampling

### Algorithm: WBVPM Synthesis
1. For each synthesis period, interpolate harmonic parameters from analysis
2. Generate complex spectrum from amplitude/phase
3. Apply IFFT to get time-domain pulse
4. Apply triangular window to avoid aliasing (buffer must be larger than pulse)
5. Overlap-add consecutive pulses at desired pitch rate

### Algorithm: Transient Detection in Residual
1. Integrate spectral phase information (Robel 2003)
2. Discriminate transient peaks from harmonic peaks
3. Translate transient components to new time instants independently
4. Add transients to resynthesized residual signal

## Figures of Interest

- **Fig 2.48 (p.82):** Blackman-Harris 92dB window - main lobe 8 bins, side lobes -92dB. Critical for IFFT synthesis quality.

- **Fig 2.49 (p.83):** Local spectra comparison showing frequency shift, amplitude scaling, and phase rotation between input S_w(k) and modified S'_w(k).

- **Fig 2.50 (p.85):** Comparison of harmonic mapping strategies for one octave down transposition (T_pitch=0.5): (a) original, (b) identity mapping [3], (c) closest frequency [5], (d) joint formant-pitch [6]. Shows "Mickey Mouse" artifacts with identity mapping.

- **Fig 2.52 (p.87):** Spectral region rendering strategy 1 (adaptive region segmentation) - source and synthesis spectrum mapping diagram.

- **Fig 2.53 (p.88):** Spectral region rendering strategy 2 (filling gaps with source spectrum) - shows hatched gap regions filled from source.

- **Fig 2.54 (p.89):** Spectral region rendering strategy 3 (filling gaps with shifted synthesis regions) - complex multi-segment mapping.

- **Fig 2.55 (p.90):** Warping function psi(k) for upwards and downwards pitch transposition showing linear interpolation regions.

- **Fig 2.56 (p.91):** Full pitch transposition pipeline with spectrum equalization showing amplitude gaps (left) vs. warped smooth result (right).

- **Fig 2.57 (p.92):** SMS analysis block diagram: SOUND -> sinusoidal analysis -> SINUSOIDS; additive synthesis -> STFT -> spectral envelope -> RESIDUAL.

- **Fig 2.58 (p.93):** Waveform representation of original, deterministic (synthesized), and residual signals with corresponding spectra.

- **Fig 2.59 (p.96):** TD-PSOLA time-scaling transformation example showing pulse repetition.

- **Fig 2.60 (p.98):** sinc_R(Omega*Delta*n) function plot showing main lobe and side lobes (R=32, Delta=8, N=256).

- **Fig 2.61 (p.99):** Spectrum estimation pipeline: overlapping pulses -> windowing -> FFT -> magnitude/phase spectra approximation.

- **Fig 2.62 (p.101):** Complete NBVPM block diagrams for (a) analysis and (b) synthesis phases with all processing stages.

- **Fig 2.63 (p.102):** Vocal fry phonation recording showing isolated glottal pulses.

- **Fig 2.64 (p.102):** Single pulse synthesis from analysis showing original vs. resynthesized waveforms.

- **Fig 2.65 (p.103):** Growl utterance waveform with significant amplitude variation between pulses.

- **Fig 2.66 (p.107):** Inter-harmonic energy contribution for different periods, pitch errors, and discontinuity correction values.

- **Fig 2.68 (p.109):** Border interpolation comparison: rectangular window (L=N) vs trapezoidal window (L>N) minimizing discontinuities.

- **Fig 2.69 (p.110):** Wide-band vs narrow-band analysis spectra comparison showing upsampled period approach.

- **Fig 2.70 (p.111):** WBVPM algorithm block diagram: analysis phase -> transformation phase -> synthesis phase.

- **Fig 2.71 (p.118):** Simplified model of harmonic phase envelope at voice pulse onsets showing formant influence on amplitude and phase.

- **Fig 2.72 (p.119):** Maximum deviation in cents around formant for different vibrato rates (2-7 Hz) and relative depths (M=0 to M=0.3).

- **Fig 2.73 (p.120):** Harmonic amplitude and phase estimation errors for stationary sinusoids with different pitch errors.

## Quotes Worth Preserving

> "However, time-domain oscillators are computationally expensive, especially when many sinusoids have to be synthesized in the case of low-pitch utterances. Therefore, it is preferable to use more efficient methods." (p.81)

> "Probably the most common one is the additive synthesis by IFFT, proposed in (Depalle and Rodet 1990) and (Dutoit 1993), where sinusoids are rendered in frequency domain by computing a few complex bin values around each sinusoid's center frequency, and adding those to the output spectrum." (p.81)

> "The effect on the timbre of the aspirated noise in voiced utterances is similar to the typical Mickey Mouse effect and sounds unnatural." (p.84)

> "Listening to them it becomes obvious that the latter examples sound better and much more natural." (p.84)

> "Voice signals are not exclusively built of harmonic components. Depending on the phonation mode, different levels of noise are present in the sound and perceived as a breathy characteristic." (p.92)

> "From the point of view of a strictly harmonic sinusoidal model, both aspects are a source of noise. Simplifying, while the former can be considered as filtered white noise, the latter adds other sinusoidal components often referred to as subharmonics." (p.92)

> "The proposed method overcomes the typical time-frequency constraints of frequency-based techniques: were several periods of signal are required in order to achieve enough frequency resolution for estimating harmonic components, thus avoiding introducing smearing in the synthesized signal and decreasing the temporal resolution." (p.105)

> "In the case of a voice signal the spectrum contains several harmonics. However, the spectral regions corresponding to each frequency component are not separated but do actually overlap." (p.84)

> "WBVPM is about 2 dB below both narrow-band cases, in the second example about 0.6 dB below, and in the third one (tenor voice with f_0 above 200Hz) about 6.5 and 15 dB below adapted and fixed window cases respectively." (p.115)

> "Maximum absolute deviation amounts. Figure 2.72 shows the maximum absolute deviation biases for different values of vibrato rate and normalized depths. As one might expect, the higher the vibrato deep or rate, the higher the deviation." (p.118)

## Implementation Notes

### Window Selection for IFFT Synthesis
- Use Blackman-Harris 92dB window for best quality
- Main lobe width: 8 bins
- Only need to compute bins at k and k +/- N*f_h*T_s (positive and negative frequency)
- Consider both positive and negative frequency components around DC and Nyquist

### Harmonic Mapping Implementation
- Store timbre envelope T_timbre as lookup table sampled at analysis frequencies
- For pitch transposition T_pitch, compute gamma(h) = round(T_timbre^{-1}(h*T_pitch*f_0)/f_0)
- Use hysteresis (threshold beta ~0.5) to prevent index jumping artifacts
- Alpha threshold ~15dB for amplitude-based index selection

### NBVPM Frame Rate Considerations
- 256 samples at 44.1kHz gives ~172 frames per second
- Window length should cover ~3 pitch periods for adequate frequency resolution
- Use 3rd order spline interpolation for smooth spectral amplitude estimation
- Apply zero-padding for better spectral resolution in non-stationary regions

### WBVPM Period Handling
- Period T may not be integer samples - use upsampling or periodization
- Periodization: repeat signal T times at rate T to get FFT buffer length M covering R periods
- Upsampling: resample to closest power of 2 >= T, but must remove aliased harmonics
- Border interpolation using trapezoidal (overlapping) windows reduces discontinuity artifacts

### Residual Processing
- Residual = original - deterministic (phase-matched sinusoidal synthesis)
- Model residual envelope with LPC, splines, or least squares fitting
- TD-PSOLA for residual preserves time structure correlated with glottal source
- Comb filter on residual attenuates harmonics, preserving only noise bands

### Inharmonicity Compensation
- Formants cause systematic frequency deviation up to 50 cents
- Deviation is independent of harmonic index but depends on formant movement speed
- Fast vibrato (6-7 Hz) with deep modulation (M=0.25-0.3) can cause significant artifacts
- WBVPM more robust to inharmonicity than narrow-band due to period-synchronized analysis

### Data Structures
```javascript
// Harmonic trajectory frame
{
  time: float,           // frame center time in seconds
  pitch: float,          // f0 in Hz
  harmonics: [{
    freq: float,         // harmonic frequency in Hz
    amp: float,          // amplitude (linear or dB)
    phase: float,        // phase in radians
    bandwidth: float     // optional: noise bandwidth coefficient eta
  }],
  residual_envelope: float[]  // spectral envelope for noise component
}

// Voice pulse (NBVPM/WBVPM)
{
  onset: float,          // pulse onset time in seconds
  period: float,         // T = 1/f0 for this pulse
  spectrum: {
    magnitude: float[],  // |X(k)| for k = 0..N/2
    phase: float[]       // angle(X(k)) for k = 0..N/2
  },
  transient: boolean     // true if contains impulsive transient
}

// Transformation parameters
{
  pitch_scale: float,    // T_pitch: 0.5 = octave down, 2.0 = octave up
  timbre_scale: float,   // T_timbre: formant scaling
  time_scale: float,     // duration modification
  spectral_tilt: float   // optional: brightness adjustment in dB/octave
}
```

### Edge Cases
- DC and Nyquist bins need special handling (no negative frequency pair)
- Very low pitch (<50 Hz) requires longer windows, may need wide-band approach
- Very high pitch (>500 Hz) may have only 2-3 periods in narrow-band window
- Pitch tracking errors cause inter-harmonic energy leakage
- Fast phonetic transitions may exceed WBVPM quasi-stationary assumption
