# Pages 000-039 Notes

## Chapters/Sections Covered

- **Title Pages and Front Matter** (pp. 0-7)
  - Half-title, series info, full title page, copyright, introduction, acknowledgments, preface to second edition
- **Table of Contents** (pp. 8-11)
- **Part I: Acoustic Theory of Speech** (begins p. 12)
- **Chapter 1.1: General Theory** (pp. 14-26)
  - 1.11 Source-Filter Description of Speech Production
  - 1.12 Segmentation
  - 1.13 The F-pattern
- **Chapter 1.2: Network Theory of Vocal Transmission** (pp. 27-40)
  - 1.21 Network Representation of Acoustic Resonators and Horns
  - 1.22 Methods of Numerical Calculations (begins p. 36)

## Key Concepts

### Source-Filter Theory (Section 1.11)
The foundational concept that speech = source * filter:
- **Source S**: Glottal excitation (periodic for voiced, noise for fricatives/aspirates)
- **Filter T**: Vocal tract transfer function
- **Output P = S * T**: Radiated speech spectrum

The speech wave is uniquely specified by source and filter characteristics. This separation allows independent analysis of:
1. Voice source (glottal pulses)
2. Vocal tract resonances (formants)

### F-Pattern Concept (Section 1.13)
The **F-pattern** at any instant of time is defined as the resonance frequencies of the oral part of the vocal tract or those resonance frequencies that show continuity with adjacent sound resonances. Key points:
- F-pattern is continuous throughout speech (unlike phoneme boundaries)
- Vowel spectrum sufficiently specified by F-pattern alone
- Consonant spectrum requires both F-pattern AND spectrum envelope
- F-pattern notation: F1, F2, F3, Fn (formant frequencies in order)

### Formant Transition Terminology
- **Positive transition**: Formant frequency rises
- **Negative transition**: Formant frequency falls
- **Fn-locus**: Whether consonant's Fn is higher or lower than adjacent vowel's Fn

### Articulatory-Acoustic Correlates
- Low F1 signals articulatory closure (constriction)
- Very low F2 signals retracted articulation (back position)
- Very high F2 signals palatal position of tongue
- High F3 indicates prepalatal or dental articulation
- Medium-high F2 position typical of dentals
- Lip closure lowers all formants (lowering amount varies)
- Very low F3 signals retroflex modification

## Equations Found

### Fundamental Frequency Definition (Eq. 1.1-2)
$$F_0 = \frac{1}{T_0}$$
Where: F0 = voice fundamental frequency (Hz), T0 = complete voice period duration (s)

### Source-Filter Product (Eq. 1.1-3)
$$|P(f)| = |S(f)| \cdot |T(f)|$$
Where: P(f) = output spectrum, S(f) = source spectrum, T(f) = filter transfer function

### Phase Relation (Eq. 1.1-4)
$$\varphi_P(f) = \varphi_S(f) + \varphi_T(f)$$
Where: phases of output, source, and transfer function respectively

### T-Network Elements for Tube Section (Eq. 1.21-1)
$$a = Z \tanh \frac{\Gamma}{2}$$
$$b = \frac{Z}{\sinh \Gamma}$$
Where: a = series element, b = parallel element, Z = characteristic impedance, Gamma = transfer constant

### Characteristic Impedance and Propagation (Eq. 1.21-2)
$$Z = \sqrt{\frac{R + j\omega L}{G + j\omega C}}$$
$$\Gamma = l\sqrt{(R + j\omega L)(G + j\omega C)} = l(\alpha + j\beta) = l \cdot \gamma$$
Where: R = series resistance, L = inductance, G = shunt conductance, C = capacitance, l = length

### Lossless Approximations (Eq. 1.21-3, 1.21-4)
$$Z = Z_0[1 - j\alpha_R/\beta + j\alpha_G/\beta]$$
$$\gamma = \alpha_R + \alpha_G + j\beta$$

Where:
$$Z_0 = \sqrt{L/C}$$
$$\beta = \omega\sqrt{LC}$$
$$\alpha_R = R/2Z_0$$
$$\alpha_G = GZ_0/2$$

### Per Unit Length Parameters (Eq. 1.21-5)
$$L = \rho/A$$
$$C = A/\rho c^2$$
Where: rho = air density, A = cross-sectional area, c = speed of sound

### Acoustic Impedance Relations (Eq. 1.21-6)
$$Z_0 = \rho c/A$$
$$\beta = \omega/c$$
$$\alpha_R = \frac{1}{c} \cdot \frac{R}{2L} = \frac{RA}{2\rho c}$$
$$\alpha_G = \frac{1}{c} \cdot \frac{G}{2C} = \frac{G\rho c}{2A}$$

### Horn Area Functions (Eq. 1.21-7, 1.21-8)
Increasing area:
$$A(x) = \frac{A_0}{\cosh^2 \varepsilon} \cosh^2 \left(\frac{x}{h} + \varepsilon\right)$$

Decreasing area:
$$A(x) = \frac{A_0 \cosh^2 \varepsilon}{\cosh^2 \left(\frac{x}{h} + \varepsilon\right)}$$

When epsilon = 0: catenoidal; epsilon = infinity: exponential; h approaching infinity: conical

### Frictional Resistance (Eq. 1.21-9, 1.21-10)
$$R = \frac{S}{2A^2}(2\mu\omega\rho)^{1/2}$$

For circular tube:
$$R = \frac{1}{Ar}(2\mu\omega\rho)^{1/2}$$
Where: mu = 1.84 x 10^-4 g/cm sec (viscosity coefficient), S = circumference, A = area, r = radius

### Inductance with Viscous Correction (Eq. 1.21-11)
$$L = \frac{\rho}{A}\left[1 + \frac{S}{A}(\mu/2\omega\rho)^{1/2}\right]$$
The correction term is negligible for vocal tract calculations.

### Heat Conduction Losses (Eq. 1.21-12)
$$G = S(\kappa - 1)\frac{\beta}{\rho c}(K_h/2\omega C_p \rho)^{1/2}$$
Where:
- K_h = coefficient of heat conduction of air
- C_p = specific heat at constant pressure of air
- C_v = specific heat at constant volume of air
- kappa = C_p/C_v
- beta = omega/c

### Numerical Loss Coefficients (Eq. 1.21-13)
Under normal atmospheric conditions (1 atmos, 20C):
$$R = \frac{1.66 \cdot 10^{-3} f^{1/2}}{A(2A/S)}$$
$$G = 2.2 \cdot 10^{-7} \cdot S \cdot f^{1/2}$$
$$\alpha_R = \frac{2.01 \cdot 10^{-5} f^{1/2}}{2A/S}$$
$$\alpha_G = \frac{0.91 \cdot 10^{-5} f^{1/2}}{2A/S}$$

### Non-Linear Flow Resistance (Eq. 1.21-14)
$$R = \frac{1.66 \cdot 10^{-3} f^{1/2}}{Ar}[1 + 2r + 2r \cdot 0.7(v/100)^{1.7}]$$
Where: r = aperture radius, v = particle velocity

### Turbulent Flow Resistance (Eq. 1.21-15)
$$R_{suff} = 2R_{flow} = \frac{\rho v}{A}$$
Where: A = cross-sectional area, v = particle velocity

### Radiation Resistance (Eq. 1.21-16)
$$R_0 = \frac{\rho\omega^2}{4\pi c} K_S(\omega)$$
Where: A_0 = radiating area, K_S(omega) = frequency-dependent factor related to baffle effect

### Radiation Reactance (Eq. 1.21-17)
$$l_a = 0.8(A_a/\pi)^{1/2}$$
Low frequency approximation for end correction length

### Internal End Correction (Eq. 1.21-18)
$$l_i = 0.48(A)^{1/2}[1 - 1.25(A_a/A)^{1/2}]$$
Additional reactance from area discontinuity between A_a and larger area A

### Transfer Ratio Equations (Eq. 1.22-1, 1.22-2)
$$U_0/U_q = b_q \Delta_{0q}/\Delta$$
$$U_0/E_v = \Delta_{0v}/\Delta$$
Where: Delta = principal determinant, Delta_0q and Delta_0v are co-factors

### Matrix Equations for 4-Section Network (Eq. 1.22-3 to 1.22-7)
Loop equations:
1. $(d_0 + d_1)U_0 - b_1 U_1 = 0$
2. $-b_1 U_0 + (d_1 + d_2)U_1 - b_2 U_2 = 0$
3. $-b_2 U_1 + (d_2 + d_3)U_2 - b_3 U_3 = E_3$
4. $-b_3 U_2 + (d_3 + d_4)U_3 = b_4 U_4$

Co-factors: $\Delta_{0q} = \Delta_{04} = b_1 b_2 b_3$

### Recursive Formant Calculation (Eq. 1.22-8)
$$Z_{lq}(\omega) = jZ_q \tan\left[\frac{\omega l_q}{c} + \arg\tan\left[\frac{A_q}{A_{q-1}} \tan\left(\frac{\omega l_{q-1}}{c} + \arg\tan\left[\frac{A_2}{A_1} \tan\left(\frac{\omega l_1}{c} + \arg\tan\frac{Z_0}{Z_1}\right)\right] \cdots\right)\right]\right]$$

### Transfer Function (Eq. 1.22-9)
$$U_q/U_0 = 1/H(\omega) = N(\omega) = N_b(\omega) + jN_a(\omega)$$
$$\varphi(\omega) = \arg N_a(\omega)/N_b(\omega)$$

### Formant Frequency and Bandwidth (Eq. 1.22-10)
$$\omega_n = 2\pi F_n$$
$$\sigma_n = -\pi B_n$$
Where: F_n = formant frequency, B_n = formant bandwidth (3 dB below peak)

### Single Resonance Transfer Function (Eq. 1.22-11)
$$H_1(j\omega) = \frac{\sigma_1^2 + \omega_1^2}{[j(\omega - \omega_1) + \sigma_1][j(\omega + \omega_1) + \sigma_1]}$$

### Phase Function (Eq. 1.22-12, 1.22-13)
$$\varphi_1(\omega) = \arg\tan\frac{\omega - \omega_1}{\sigma_1} + \arg\tan\frac{\omega + \omega_1}{\sigma_1}$$
$$\frac{d\varphi_1(\omega)}{d\omega} = \frac{\sigma_1}{\sigma_1^2 + (\omega - \omega_1)^2} + \frac{\sigma_1}{\sigma_1^2 + (\omega + \omega_1)^2}$$

### Pole Detection via Phase (Eq. 1.22-15, 1.22-16, 1.22-17)
Second derivative of phase function equals zero when:
$$\omega = \omega_1 \sqrt{\frac{2\omega_0}{\omega_1} - \frac{\omega_0^2}{\omega_1^2}}$$

Or:
$$\omega_{1e} = \omega_1 \sqrt{2\sqrt{1 + \frac{1}{4Q_1^4}} - 1 - \frac{1}{4Q_1^2}}$$
Where: $\omega_0^2 = \omega_1^2 + \sigma_1^2$ and $Q_1 = \omega_1/2\sigma_1$

### Close Formant Peak Frequency (Eq. 1.22-18)
$$\omega_{p1} = \omega_1(1 - 1/4Q^2)^{1/2}$$
$$F_{p1} = F_1(1 - 1/4Q^2)^{1/2}$$

A first formant of 100 c/s bandwidth and 250 Hz pole frequency has peak at 245 c/s; 90-degree phase shift at 255 c/s (Eq. 1.22-14 gives ideal as 248.8 c/s)

## Parameters and Data

| Parameter | Symbol | Value | Units | Context |
|-----------|--------|-------|-------|---------|
| Speed of sound | c | ~35000 | cm/s | Standard conditions |
| Air density | rho | ~0.00114 | g/cm^3 | Standard conditions |
| Viscosity coefficient | mu | 1.84 x 10^-4 | g/cm sec | Air at 20C |
| Formant spacing (male avg) | - | ~1000 | c/s (Hz) | Statistical average |
| Vocal tract length (male) | - | ~17.5 | cm | Physiological average |
| Radiating baffle radius | - | 9 | cm | Spherical baffle model |
| Radiating area (typical) | A_0 | 2-8 | cm^2 | Mouth opening |
| F0 max unvoiced | - | <30 | c/s | Turbulent noise source |

## Vocal Tract Models

### Transmission Line Model (Section 1.21)
The vocal tract is represented as a cascade of **acoustic transmission line sections**:
- Each section has cross-sectional area A and length l
- Represented by T-network with series inductance and shunt capacitance
- Losses modeled via series resistance R (viscous) and shunt conductance G (thermal)

**Key insight**: For wavelengths > 8l, lumped element approximation is valid.

### Horn Models (Section 1.21, Fig. 1.2-2)
Three horn types for vocal tract modeling:
1. **Catenoidal** (epsilon = 0): One network element vanishes, allows continuous interconnection
2. **Exponential** (epsilon = infinity)
3. **Conical** (h approaching infinity)

The catenoidal horn is particularly useful for modeling:
- Palatal constriction region (vowels [i], [e])
- Mouth cavity with concave area function
- Pharynx in back vowels (convex area function)

### 4-Section Resonator (Fig. 1.2-5)
General vocal tract approximation uses 4 sections:
- Each section: area A_n, length l_n
- Network: series a elements, shunt b elements
- Determinant analysis gives formant frequencies
- Zeros occur when d_3 + d_4 = 0

## Formant Data

### Formant-Articulation Correlates (from Section 1.13)
| Articulation | F1 | F2 | F3 |
|-------------|-----|-----|-----|
| Articulatory closure | Low | - | - |
| Retracted (back) | - | Very low | - |
| Palatal position | - | Very high | - |
| Prepalatal/dental | - | Medium-high | High |
| Lip rounding | Lowered | Lowered | Lowered |
| Retroflex | - | - | Very low |

### First Formant Analysis Example (p. 40)
- F1 = 250 Hz, B1 = 100 Hz
- Q1 = F1/(2*B1/pi) = approx. 4
- Peak frequency F_p1 = 245 Hz (vs pole at 250 Hz)
- 90-degree phase shift at 255 Hz

## Figures of Interest

- **Fig. 1.1-1 (p. 16)**: Block diagram of source-filter model. Part a) shows schematic with source, pharynx cavity, mouth cavity, nasal cavity, and oral output. Part b) shows four-terminal network with internal impedance, vocal cavities, and radiation impedance.

- **Fig. 1.1-2 (p. 19)**: Source-filter decomposition illustrated. Shows vocal cord pulses -> sawtooth waveform -> source spectrum S(f) declining at -12 dB/octave -> multiplied by T(f) filter function -> output spectrum P(f) = S(f)*T(f). **Critical for understanding formant synthesis.**

- **Fig. 1.2-1 (p. 28)**: T-network equivalent for acoustic tube sections. Shows progression from simple tube (Z0) to distributed elements (R, L, C, G) to T-network (a, b elements). Essential for understanding transmission line modeling.

- **Fig. 1.2-2 (p. 30)**: Horn resonators and equivalent networks. Shows catenoidal, exponential, and conical horn shapes with their equivalent circuit formulas. Important for lip and pharynx modeling.

- **Fig. 1.2-3 (p. 32)**: Radiation resistance factor K_S vs frequency. Shows baffle effect: K_S approaches 1 at low frequencies (simple point source), increases at mid frequencies due to baffle, then decreases at high frequencies.

- **Fig. 1.2-4 (p. 35)**: Normalized radiation resistance and reactance curves. Shows R_0/A and X_0/A vs normalized frequency. The omega^2 dependency of radiation resistance extends to about 6500 c/s for A_0 = 8 cm^2 mouth opening.

- **Fig. 1.2-5 (p. 37)**: Generalized 4-section resonator network. Top: physical tube model with areas A1-A4 and lengths l1-l4. Bottom: equivalent T-network with a and b elements. Foundation for numerical vocal tract calculations.

## Implementation Notes

### For Klatt Synthesizer
1. **Source-filter separation** is the fundamental architecture:
   - Implement source generator (glottal pulse, noise)
   - Implement filter (cascade of resonators)
   - Output = source * filter

2. **Formant frequencies F1, F2, F3...** are the poles of the transfer function
   - Peak frequency is slightly lower than pole frequency when Q is low
   - For F1 = 250 Hz, B1 = 100 Hz: peak at 245 Hz, not 250 Hz

3. **Bandwidth determines damping**: sigma_n = -pi*B_n
   - Typical B1 = 60-100 Hz for first formant
   - Higher formants have larger bandwidths

4. **Radiation characteristic**:
   - High-pass effect (+6 dB/octave from radiation)
   - Baffle effect modeled by K_S factor
   - For frequencies < 3000 Hz with 8 cm^2 opening: omega^2 dependency

5. **Loss mechanisms** (for realistic damping):
   - Frictional (viscous) losses: proportional to sqrt(f)
   - Heat conduction losses: also proportional to sqrt(f)
   - Wall vibration losses: can add shunt conductance

6. **Area function discretization**:
   - Divide vocal tract into sections (typically 4-8 for vowels)
   - Each section: constant area A, length l
   - Calculate formants from determinant of network matrix

### Critical Constants for Implementation
```
c = 35000 cm/s          // Speed of sound
rho = 0.00114 g/cm^3    // Air density
Z_0 = rho*c/A           // Characteristic impedance (per area A)
L = rho/A               // Inductance per unit length
C = A/(rho*c^2)         // Capacitance per unit length
```

### Formant Bandwidth Rule
From Eq. 1.22-10, the relationship between bandwidth B_n and damping sigma_n:
```javascript
sigma_n = -Math.PI * B_n;  // Damping constant (rad/s)
omega_n = 2 * Math.PI * F_n;  // Angular frequency (rad/s)
```

## Quotes Worth Preserving

> "The speech wave is the response of the vocal tract filter systems to one or more sound sources. This simple rule, expressed in the terminology of acoustic and electrical engineering, implies that the speech wave may be uniquely specified in terms of *source* and *filter* characteristics." (p. 15)

> "There is some degree of correspondence between the phonetic term *phonation* and the technical term *source* and similarly between *articulation* and *filter*." (p. 17)

> "The spectral peaks of the sound spectrum |P(f)| are called *formants*." (p. 20)

> "The basic principle of the theory of voiced sounds is that, to a first order of approximation, the filter function is independent of the source." (p. 20)

> "Formants are labeled F1, F2, F3, etc., in the order they occur in the frequency scale." (p. 21)

> "Distances between formants in the frequency scale average 1000 c/s for males. This statistical average is physiologically correlated with the total length of the vocal tract." (p. 21)

> "*F-pattern.* The F-pattern, at any instant of time, is defined as the resonance frequencies of the oral part of the vocal tract or those resonance frequencies that show a continuity with the oral resonances of an adjacent sound." (p. 25)

> "The vowel spectrum is sufficiently specified by the F-pattern, whereas the consonant spectrum should in addition be specified by its spectrum envelope." (p. 26)

> "The network representation of the vocal tract is based on the analogous acoustic impedance which is the ratio of pressure to volume velocity." (p. 27)
