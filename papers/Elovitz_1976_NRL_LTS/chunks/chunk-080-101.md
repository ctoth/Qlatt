# Pages 080-101 Notes

## Chapters/Sections Covered

| Section | Page Range | Description |
|---------|------------|-------------|
| TRANS Program (continued) | 080-089 | Utility functions: VOTRAXTRANSLATE, READTEXT, ASCII, CLI, FILEDEFINE, FILEOUT |
| Appendix B | 090-099 | DICT program documentation and complete SNOBOL4 listing |
| Appendix C | 100-101 | Conversion of software to FASBOL compiler |

## Key Findings

### TRANS Program Utility Functions (Pages 80-89)

1. **VOTRAXTRANSLATE** (p.80): Translates IPA notation to VOTRAX speech synthesizer symbols
   - Phonemes may be delimited by slashes
   - Removes double blanks from output

2. **READTEXT** (p.81-82): Reads series of text to be translated
   - Handles illegal punctuation: `[]/\`
   - Valid punctuation symbols: `.,;+<>?*=-:)(&%$"!` plus single quote
   - Inserts blanks around punctuation so each word is delimited
   - Supports cassette output option for TI 960A Speech Lab
   - Optional statistics file output

3. **ASCII** (p.83): Translates output to ASCII format
   - Removes brackets `[` and `]`
   - Handles end-of-word blanks

4. **CLI** (p.84): Command line interface for translation type selection
   - Input formats: ENGLISH, IPA
   - Output formats: ENGLISH, IPA, VOTRAX, ASCII

5. **FILEDEFINE** (p.85-87): Defines file numbers for I/O
   - INNO = 22 (input file)
   - STATNO = 23 (statistics file)
   - TRANSNO = 24 (translation output file)
   - Supports TTY and cassette I/O

6. **FILEOUT** (p.88): Outputs VOTRAX mnemonic codes to file
   - DC2 = RECORDON (cassette record on)
   - DC4 = RECORDOFF
   - `~` is end of message character for TI Speech Lab
   - Breaks output into 70-character blocks

7. **Error Messages** (p.89):
   - NORULEAPPLIES: "NO RULE APPLIES. RULES ATTEMPTING TO USE ARE..."
   - RULESYNTAXERROR: "SYNTAX ERROR IN RULE FORMATION"
   - EOF handling with continue option

### Appendix B: DICT Program (Pages 90-99)

**Purpose**: DICT searches a dictionary file for all words matching a specified rule pattern. This allows testing proposed alterations or additions to the rules.

**Key Features**:
- Rule format similar to translation rules (left part only, no translation needed)
- Brackets `[` and `]` not needed since only matching is performed
- Special symbols retain meaning from translation program
- Double quote `"` can delimit trailing blanks

**Sample Dialog (Figure B1, p.91)**:
```
WHAT IS THE CONTEXT TO SEARCH FOR?
*U*
SEARCH STARTING
   ENGLISH         IPA
EUROPE
EUROPEAN
MEDIUM
NEUTRAL
MUSEUM
LIEUTENANT
TOTAL MATCHES: 6

WHAT IS THE CONTEXT TO SEARCH FOR?
*NGTH
MONTHS
STRENGTH
LENGTH
RIGHTS
THOUGHTS
...
TOTAL MATCHES: 9
```

**DICT Program Structure**:

1. **Variable Definitions** (p.93):
   - VOWEL = 'AEIOUY'
   - CONSONANT = 'BCDFGHJKLMNPQRSTVWXZ'
   - VOICED = 'BDVGJLMNRWZ'
   - FRONT = 'EIY'
   - SUFFIX = 'ER' | 'E' | 'ES' | 'ED' | 'ING' | 'ELY'
   - SIBILANT = ANY('SCGZXJ') | 'CH' | 'SH'
   - NONPAL = ANY('TSRDLZNJ') | 'TH' | 'CH' | 'SH'

2. **Special Pattern Symbols**:
   - `#` = ANY(VOWEL) ARBNO(ANY(VOWEL)) - one or more vowels
   - `*` = ANY(CONSONANT) ARBNO(ANY(CONSONANT)) - one or more consonants
   - `.` = ANY(VOICED) - single voiced consonant
   - `$` = ANY(CONSONANT) ANY('EI') - consonant followed by E or I
   - `%` = SUFFIX - common suffixes
   - `&` = SIBILANT
   - `@` = NONPAL (non-palatal consonants)
   - `^` = ANY(CONSONANT) - single consonant
   - `+` = ANY(FRONT) - front vowel
   - `:` = ARBNO(ANY(CONSONANT)) - zero or more consonants

3. **FIND Function** (p.95-96): Searches dictionary arrays for rule matches
   - Parameters: RULE, QUAL (ENG or IPA), INDEX
   - Supports indexed search for efficiency

4. **READFILE Function** (p.98): Reads dictionary into parallel arrays
   - ENGDICT array - English words
   - IPADICT array - IPA transcriptions
   - Dictionary file format: `ENGLISHWORD ENDTEXTMARK IPAWORD ENDTEXT`
   - Maximum size: 4000 entries

5. **SPECIALCASEPROC** (p.97): Builds SNOBOL patterns from special symbols

### Appendix C: Conversion to FASBOL (Pages 100-101)

**Problem**: SNOBOL4 on PDP-10 is interpretive, causing inefficiency
- Translating 1000-word Brown Corpus sample required overnight computer run
- TRANS was research tool, not production software

**Solution**: Conversion to FASBOL (compiled SNOBOL)

**Performance Improvements**:

| Program | FASBOL Speedup |
|---------|---------------|
| TRANS | ~25x faster |
| DICT (file reading) | 35x faster |
| DICT (pattern matching) | 3-8x faster |

**Translation Speed**:
- After FASBOL conversion: ~1 word every 0.5-2 seconds
- Within factor of 4-5 of real-time speech rates
- Implementation optimized for experimentation, not efficiency

**Memory Benefits**:
- FASBOL reduced memory requirements threefold
- Enabled running DICT on much larger word lists

**Note**: Report publishes SNOBOL versions since SNOBOL4 interpreters more widely available than FASBOL compiler. FASBOL versions available from authors.

## Parameters Found

| Name | Value | Description |
|------|-------|-------------|
| DICTSIZE | 4000 | Maximum dictionary entries for DICT program |
| STLIMIT | 100000000 | SNOBOL statement limit |
| INNO | 22 | Input file number |
| STATNO | 23 | Statistics file number |
| TRANSNO | 24 | Translation output file number |
| OUTNO | 24 | DICT output file number |

## Algorithms/Procedures

### DICT Pattern Matching Algorithm

1. Read rule from user
2. Check for special symbols in rule
3. If special symbols present, call SPECIALCASEPROC to build pattern
4. For each dictionary entry:
   a. Match entry against pattern
   b. If match, output entry and increment TOTAL
5. Report total matches
6. Loop for next rule

### SPECIALCASEPROC Pattern Building

1. Initialize PATTERN = NULL
2. For each character in RULE:
   a. If character in SPECIALCASE set (#*.$%&@^+:)
   b. Build corresponding SNOBOL pattern from definitions
   c. Concatenate to PATTERN
3. Return completed PATTERN

## Figures/Tables of Interest

| Figure | Page | Description |
|--------|------|-------------|
| Fig. B1 | 91 | Sample dialog with DICT showing rule testing examples |

**Figure B1 Details**: Shows interactive session testing rules:
- `*U*` matches EUROPE, EUROPEAN, MEDIUM, NEUTRAL, MUSEUM, LIEUTENANT (6 matches)
- `*NGTH` matches MONTHS, STRENGTH, LENGTH, RIGHTS, THOUGHTS, etc. (9 matches)
- `EAD` matches HEAD, ALREADY, DEAD, INSTEAD, READ, READY, READING, LEAD, AHEAD, LEADERS, LEADERSHIP, SPREAD, LEADER, LEADING, HEADQUARTERS, HEADED, HEADS, READER, READILY, BREAD, STEADY, REAVERS, LEADS, HEAVING, WIDESPREAD (25 matches)

## Implementation Notes

### For Qlatt TTS Implementation

1. **Pattern Symbol Translation**: The special symbols used in rules can be implemented as:
   ```javascript
   const PATTERNS = {
     '#': /[AEIOUY]+/,           // one or more vowels
     '*': /[BCDFGHJKLMNPQRSTVWXZ]+/, // one or more consonants
     '.': /[BDVGJLMNRWZ]/,       // single voiced consonant
     '$': /[BCDFGHJKLMNPQRSTVWXZ][EI]/, // consonant + front vowel
     '%': /(ER|E|ES|ED|ING|ELY)/, // suffix
     '&': /(CH|SH|[SCGZXJ])/,    // sibilant
     '@': /(TH|CH|SH|[TSRDLZNJ])/, // non-palatal
     '^': /[BCDFGHJKLMNPQRSTVWXZ]/, // single consonant
     '+': /[EIY]/,               // front vowel
     ':': /[BCDFGHJKLMNPQRSTVWXZ]*/ // zero or more consonants
   };
   ```

2. **Testing Tool**: A JavaScript equivalent of DICT would be valuable for testing rule changes against a dictionary

3. **Performance Consideration**: The original system achieved ~1 word per 0.5-2 seconds on 1976 hardware. Modern JavaScript should handle rules instantaneously.

4. **Output Formats**: The system supported multiple output formats:
   - IPA (phonetic transcription)
   - VOTRAX (synthesizer-specific codes)
   - ASCII (readable phonetic notation)

   Consider supporting multiple output notations in Qlatt.

### Code Quality Notes

- SNOBOL4 pattern matching is remarkably expressive for this task
- The rule format with context-sensitive patterns maps well to modern regex
- DICT program demonstrates value of having a rule testing tool separate from synthesis

## Evaluation Data

No formal evaluation metrics in this chunk. The performance data relates to computational speed, not transcription accuracy.

**Speed Benchmarks** (FASBOL on PDP-10, circa 1975):
- Translation: ~30-120 words/minute
- Approximately 4-5x slower than real-time speech

## Phoneme Set Notes (from DICT variable definitions)

**Vowels**: A, E, I, O, U, Y (6 letters)

**Consonants**: B, C, D, F, G, H, J, K, L, M, N, P, Q, R, S, T, V, W, X, Z (20 letters)

**Voiced Consonants**: B, D, V, G, J, L, M, N, R, W, Z (11 letters)

**Front Vowels**: E, I, Y (3 letters)

**Sibilants**: S, C, G, Z, X, J, CH, SH (8 patterns)

**Non-palatals**: T, S, R, D, L, Z, N, J, TH, CH, SH (11 patterns)

**Common Suffixes**: -ER, -E, -ES, -ED, -ING, -ELY (6 suffixes)
